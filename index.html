<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Invitación Épica Halloween — Daniel & Sabrina</title>
<meta name="theme-color" content="#ff6b00" />
<meta name="description" content="Invitación especial para la fiesta de Halloween de Daniel y Sabrina. ¡No te la pierdas!" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;500;700;800&family=Creepster&family=Cinzel:wght@600;700&display=swap" rel="stylesheet">
<style>
/* =========================
   VARIABLES & RESET
   ========================= */
:root{
  --bg:#07040a;
  --bg2:#100718;
  --orange:#ff6b00;
  --orange-2:#ff8c1a;
  --purple:#6b2db5;
  --pink:#b83af5;
  --white:#f6f3ff;
  --muted:#c9b7ff;
  --glow:0 0 18px rgba(255,107,0,.55),0 0 36px rgba(255,107,0,.35);
  --softglow:0 0 22px rgba(184,58,245,.35);
  --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;scroll-behavior:smooth}
body{
  font-family: 'Montserrat',system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,sans-serif;
  background:
    radial-gradient(1200px 600px at 10% -10%, #1a0f2a 0%, transparent 60%),
    radial-gradient(900px 500px at 110% 10%, #2a0c20 0%, transparent 60%),
    linear-gradient(180deg, var(--bg), var(--bg2) 55%, #060308 100%);
  color:var(--white);
  overflow-x:hidden;
  perspective: 1000px;
}

/* =========================
   BACKGROUND FX (FOG + GRID)
   ========================= */
.bg-noise{
  position:fixed;inset:0;pointer-events:none;z-index:1;
  background-image: radial-gradient(transparent 70%, rgba(0,0,0,.6)), repeating-linear-gradient(90deg, rgba(255,255,255,.02) 0 2px, transparent 2px 4px);
  mix-blend-mode:soft-light;opacity:.25
}
.fog, .fog:before, .fog:after{
  position:fixed;inset:-20vh -20vw;content:"";z-index:2;pointer-events:none;
  background: radial-gradient(60vw 40vh at 50% 60%, rgba(255,255,255,.06), transparent 60%);
  filter: blur(18px) saturate(1.2);
  animation: fogMove 60s linear infinite;
}
.fog:before{animation-duration:85s;mix-blend-mode:screen}
.fog:after{animation-duration:100s;mix-blend-mode:screen}

@keyframes fogMove{
  0%{transform:translate3d(-10vw,-5vh,0) scale(1)}
  50%{transform:translate3d(10vw,8vh,0) scale(1.05)}
  100%{transform:translate3d(-10vw,-5vh,0) scale(1)}
}

/* =========================
   MOVERS: BATS & GHOSTS
   ========================= */
.mover{ position:fixed; top:50%; left:-10vw; z-index:3; opacity:.95; pointer-events:none; }
.mover span{display:inline-block;filter:drop-shadow(0 6px 12px rgba(0,0,0,.7))}
.mover.ghost span{ font-size: clamp(28px, 6vw, 70px) }
.mover.bat span{ font-size: clamp(18px, 4.5vw, 46px) }
.mover.bat{ animation: batPath 14s linear infinite; }
.mover.ghost{ animation: ghostPath 18s linear infinite; }
@keyframes batPath{
  0%{ transform: translateX(-10vw) translateY(-8vh) rotate(0deg) }
  20%{ transform: translateX(20vw) translateY(-12vh) rotate(-10deg) }
  40%{ transform: translateX(45vw) translateY(-2vh) rotate(4deg) }
  60%{ transform: translateX(70vw) translateY(-14vh) rotate(-6deg) }
  80%{ transform: translateX(95vw) translateY(0) rotate(2deg) }
  100%{ transform: translateX(120vw) translateY(-6vh) rotate(0deg) }
}
@keyframes ghostPath{
  0%{ transform: translateX(-10vw) translateY(0) }
  30%{ transform: translateX(35vw) translateY(-6vh) }
  60%{ transform: translateX(70vw) translateY(6vh) }
  100%{ transform: translateX(120vw) translateY(0) }
}
/* ghost wobble */
.ghost-wobble{ animation: wobble 2.2s ease-in-out infinite }
@keyframes wobble{
  0%,100%{ transform: translateY(0) }
  50%{ transform: translateY(-10px) }
}

/* =========================
   HEADER / HERO
   ========================= */
header.hero{
  position:relative; z-index:5;
  padding: clamp(28px, 5vw, 48px) 16px 0;
  text-align:center;
  transform: translateY(0);
  animation: headerFloat 6s ease-in-out infinite;
}
@keyframes headerFloat {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-10px); }
}

.badge{
  display:inline-flex; align-items:center; gap:.6rem;
  padding:.5rem 1rem; border:1px solid rgba(255,255,255,.14);
  background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
  border-radius:999px; font-weight:700; letter-spacing:.12em; font-size:.8rem;
  box-shadow: inset 0 0 18px rgba(255,255,255,.06);
  color:var(--muted);
  backdrop-filter: blur(10px);
  transform: translateZ(0);
  will-change: transform;
}
.badge:hover {
  transform: scale(1.05);
  box-shadow: inset 0 0 18px rgba(255,255,255,.06), 0 0 20px rgba(255,107,0,.3);
}

.title{
  margin: .9rem auto 0;
  font-family:'Creepster', cursive;
  font-size: clamp(40px, 8vw, 104px);
  line-height: .95;
  color: var(--orange-2);
  text-shadow: 0 4px 0 #000, var(--glow);
  letter-spacing:.03em;
  animation: titlePulse 3.8s ease-in-out infinite;
  transform: perspective(800px) rotateX(5deg);
}
@keyframes titlePulse{
  0%,100%{ filter: drop-shadow(0 0 18px rgba(255,107,0,.55)); transform: perspective(800px) rotateX(5deg) scale(1) }
  50%{ filter: drop-shadow(0 0 28px rgba(255,140,26,.75)); transform: perspective(800px) rotateX(3deg) scale(1.03) }
}

.subtitle{
  font-family:'Cinzel', serif;
  font-size: clamp(18px, 2.6vw, 28px);
  color: #ffd9b0;
  margin-top:.3rem;
  text-shadow: 0 0 18px rgba(255,140,26,.45);
  opacity: 0;
  animation: fadeIn 1s ease-out 0.5s forwards;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

.info-strip{
  margin: 18px auto 0;
  display:flex; flex-wrap:wrap; gap:.6rem; justify-content:center;
  opacity: 0;
  animation: fadeIn 1s ease-out 1s forwards;
}
.info-chip{
  display:flex; align-items:center; gap:.5rem;
  padding:.55rem .85rem;
  background: rgba(255,107,0,.08);
  border:1px solid rgba(255,107,0,.32);
  border-radius:12px;
  color:#ffd9c0; font-weight:700;
  box-shadow: inset 0 0 22px rgba(255,107,0,.15);
  backdrop-filter: blur(10px);
  transform: translateY(20px);
  opacity: 0;
  animation: chipFloat 0.8s ease-out forwards;
  animation-delay: calc(var(--delay) * 0.2s);
}
@keyframes chipFloat {
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* =========================
   MAIN CARD
   ========================= */
.main{
  position:relative; z-index:5;
  max-width: 980px; margin: clamp(20px, 3vw, 40px) auto 0;
  padding: 0 16px;
}
.invite{
  position:relative;
  background:
    radial-gradient(120% 140% at 10% 10%, rgba(255,107,0,.15), transparent 55%),
    radial-gradient(120% 140% at 98% 4%, rgba(184,58,245,.14), transparent 55%),
    linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
  border:1px solid rgba(255,255,255,.15);
  border-radius:24px;
  overflow:hidden;
  box-shadow:
    0 40px 120px rgba(0,0,0,.55),
    inset 0 0 40px rgba(255,107,0,.08),
    inset 0 0 60px rgba(184,58,245,.08);
  transform: translateY(30px);
  opacity: 0;
  animation: cardFloat 1s ease-out 1.2s forwards;
  will-change: transform, opacity;
}
@keyframes cardFloat {
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* top glow edge */
.invite:before{
  content:""; position:absolute; inset:0; pointer-events:none;
  background: radial-gradient(70% 40% at 50% -10%, rgba(255,107,0,.25), transparent 60%);
  mix-blend-mode:screen;
}

/* Grid two columns (stacks on mobile) */
.invite-inner{ display:grid; grid-template-columns: 1.1fr .9fr; gap: 22px; padding: clamp(22px, 3.4vw, 34px); }
@media (max-width: 860px){
  .invite-inner{ grid-template-columns: 1fr; }
}

/* left: details */
.details{
  padding: clamp(12px, 1.6vw, 18px);
}
.names{
  font-family:'Cinzel', serif;
  font-size: clamp(26px, 3.2vw, 36px);
  color:#ffd7b0; letter-spacing:.04em;
  text-shadow: 0 0 20px rgba(255,107,0,.25);
  margin-bottom: 8px;
  opacity: 0;
  animation: fadeIn 0.6s ease-out 0.3s forwards;
}
.tagline{
  font-weight:700; text-transform:uppercase; letter-spacing:.2em;
  color:#ffe7d1; opacity:.9; font-size:.9rem; margin-bottom: 18px;
  opacity: 0;
  animation: fadeIn 0.6s ease-out 0.5s forwards;
}

/* bullet list stylish */
.bullets{ display:grid; gap:12px; margin: 10px 0 6px }
.item{
  display:flex; align-items:center; gap:.8rem;
  padding: 10px 12px; border-radius: 12px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.25);
  transition:var(--transition);
  transform: translateX(-20px);
  opacity: 0;
  animation: itemSlide 0.6s ease-out forwards;
}
.item:nth-child(1) { animation-delay: 0.7s; }
.item:nth-child(2) { animation-delay: 0.9s; }
.item:nth-child(3) { animation-delay: 1.1s; }
.item:nth-child(4) { animation-delay: 1.3s; }

@keyframes itemSlide {
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

.item:hover{ 
  transform: translateX(4px) scale(1.02); 
  border-color: rgba(255,107,0,.35); 
  background: rgba(255,107,0,.08);
  box-shadow: 0 8px 25px rgba(255,107,0,.15);
}
.item .ico{ 
  font-size: 22px; 
  filter: drop-shadow(0 4px 10px rgba(0,0,0,.6));
  transform: rotate(0deg);
  transition: transform 0.3s ease;
}
.item:hover .ico {
  transform: rotate(15deg) scale(1.2);
}
.item .txt{ font-weight:600; color:#f2e9ff }

/* right: poster / image placeholder (animated) */
.poster{
  position:relative; display:flex; align-items:center; justify-content:center;
  min-height: 280px;
  border-radius: 18px;
  border:1px dashed rgba(255,255,255,.18);
  overflow:hidden;
  background: radial-gradient(80% 60% at 50% 40%, rgba(255,107,0,.16), rgba(184,58,245,.10) 40%, transparent 65%),
              url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="800" height="600"><defs><radialGradient id="g" cx="50%" cy="40%" r="65%"><stop offset="0%" stop-color="%23ff6b00" stop-opacity=".12"/><stop offset="70%" stop-color="%23000000" stop-opacity="0"/></radialGradient></defs><rect width="100%" height="100%" fill="url(%23g)"/></svg>');
  transform: rotateY(0deg);
  animation: posterFloat 6s ease-in-out infinite;
  will-change: transform;
}
@keyframes posterFloat {
  0%, 100% { transform: rotateY(0deg) rotateX(0deg); }
  50% { transform: rotateY(5deg) rotateX(2deg); }
}

.poster-title{
  font-family:'Creepster', cursive;
  font-size: clamp(38px, 6.8vw, 86px);
  color: var(--orange-2);
  letter-spacing: .04em;
  text-shadow: 0 6px 0 #000, var(--glow);
  transform: perspective(800px) rotateX(9deg);
  animation: titlePulse 3.8s ease-in-out infinite;
  text-align: center;
  line-height: 1.1;
}
@keyframes titlePulse{
  0%,100%{ filter: drop-shadow(0 0 18px rgba(255,107,0,.55)); transform: perspective(800px) rotateX(9deg) scale(1) }
  50%{ filter: drop-shadow(0 0 28px rgba(255,140,26,.75)); transform: perspective(800px) rotateX(6deg) scale(1.03) }
}

/* =========================
   CTA BUTTONS (each with effect)
   ========================= */
.cta-row{
  margin-top: clamp(14px, 2.2vw, 20px);
  display:flex; flex-wrap:wrap; gap: 12px;
  opacity: 0;
  animation: fadeIn 0.8s ease-out 1.5s forwards;
}
.btn{
  --bcol: rgba(255,255,255,.14);
  display:inline-flex; align-items:center; gap:.6rem;
  padding:.9rem 1.1rem; border-radius:12px;
  border:1px solid var(--bcol); color:#fff; font-weight:800;
  text-decoration:none; position:relative; overflow:hidden;
  background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
  transition:var(--transition);
  will-change: transform;
  transform: translateY(20px);
  opacity: 0;
  animation: btnFloat 0.6s ease-out forwards;
}
.btn:nth-child(1) { animation-delay: 1.7s; }
.btn:nth-child(2) { animation-delay: 1.9s; }
.btn:nth-child(3) { animation-delay: 2.1s; }
.btn:nth-child(4) { animation-delay: 2.3s; }

@keyframes btnFloat {
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

.btn:active{ transform: translateY(1px) scale(.99) }
.btn .spark{ position:absolute; inset:0; pointer-events:none; background: radial-gradient(400px 80px at var(--mx,50%) var(--my,50%), rgba(255,107,0,.22), transparent 60%); opacity:.0; transition:.2s opacity }
.btn:hover .spark{ opacity:.9 }
.btn.whatsapp{ border-color: rgba(37,211,102,.4) }
.btn.map{ border-color: rgba(255,107,0,.35) }
.btn.dress{ border-color: rgba(184,58,245,.35) }
.btn.music{ border-color: rgba(255,255,255,.35) }
.btn.cal{ border-color: rgba(255,196,0,.35) }

/* button icons */
.btn .i{ font-size: 20px; filter: drop-shadow(0 2px 6px rgba(0,0,0,.5)) }

/* special effects containers */
#flash-overlay{
  position:fixed; inset:0; background: radial-gradient(ellipse at center, rgba(255,255,255,.95), rgba(255,255,255,.0) 60%);
  mix-blend-mode:screen; opacity:0; pointer-events:none; z-index:9999;
}
.flash-show{ animation: flash 600ms ease forwards }
@keyframes flash{
  0%{opacity:0}
  15%{opacity:1}
  100%{opacity:0}
}
.shake{ animation: shake .6s cubic-bezier(.36,.07,.19,.97) both }
@keyframes shake{
  10%,90%{transform: translate3d(-1px,0,0)}
  20%,80%{transform: translate3d(2px,0,0)}
  30%,50%,70%{transform: translate3d(-4px,0,0)}
  40%,60%{transform: translate3d(4px,0,0)}
}
.fog-burst{
  position:fixed; inset:0; pointer-events:none; z-index:9998; opacity:0;
  background: radial-gradient(40vw 28vh at var(--x,50%) var(--y,70%), rgba(255,255,255,.22), transparent 70%);
  filter: blur(14px);
  animation: fogPulse 1200ms ease-out forwards;
}
@keyframes fogPulse{
  0%{opacity:.0; transform: scale(.6)}
  20%{opacity:.7}
  100%{opacity:0; transform: scale(1.4)}
}
.lightning{
  position:fixed; inset:0; pointer-events:none; z-index:9998; opacity:0;
  background:
    repeating-linear-gradient(115deg, rgba(255,255,255,.96) 0 2px, transparent 2px 6px),
    radial-gradient(1000px 600px at var(--x,60%) var(--y,30%), rgba(255,255,255,.8), transparent 60%);
  mix-blend-mode:screen; filter: blur(1px);
  animation: bolt .35s steps(2) 2;
}
@keyframes bolt{
  0%{opacity:0}
  40%{opacity:.95}
  100%{opacity:0}
}

/* =========================
   FLOATING MUSIC TOGGLE
   ========================= */
.music-fab{
  position: fixed; right: 14px; bottom: 14px; z-index: 10;
  display:flex; align-items:center; gap:8px;
  padding:.75rem .9rem; border-radius:999px; cursor:pointer;
  background: radial-gradient(120px 40px at 30% 20%, rgba(255,107,0,.35), rgba(255,255,255,.06));
  border:1px solid rgba(255,255,255,.2);
  box-shadow: 0 10px 30px rgba(0,0,0,.45), inset 0 0 18px rgba(255,107,0,.2);
  transition: var(--transition);
  transform: scale(1);
  opacity: 1;
  animation: fabFloat 3s ease-in-out infinite;
}
.music-fab:hover {
  transform: scale(1.05);
  box-shadow: 0 12px 35px rgba(0,0,0,.5), inset 0 0 18px rgba(255,107,0,.25);
}
@keyframes fabFloat {
  0%, 100% { transform: scale(1) translateY(0); }
  50% { transform: scale(1.03) translateY(-3px); }
}

.music-fab .disc{
  width: 28px; height: 28px; border-radius:50%;
  background: conic-gradient(#000 0 25%, #333 0 50%, #000 0 75%, #333 0);
  border: 2px solid rgba(255,255,255,.2);
  box-shadow: inset 0 0 10px rgba(255,255,255,.05);
  transition: var(--transition);
}
.playing .disc{ animation: spin 4.4s linear infinite }
@keyframes spin{ to{ transform: rotate(360deg) }}

/* =========================
   OVERLAY: TAP TO START (for audio policies)
   ========================= */
#gate{
  position: fixed; inset:0; z-index: 99999; display:grid; place-items:center;
  background: radial-gradient(1200px 900px at 50% 10%, rgba(255,107,0,.08), transparent 60%), #030206;
  backdrop-filter: blur(10px);
}
.gate-card{
  text-align:center; padding: 28px 20px; width:min(520px, 92vw);
  border:1px solid rgba(255,255,255,.16); border-radius: 18px;
  background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
  box-shadow: 0 30px 100px rgba(0,0,0,.7), inset 0 0 30px rgba(255,107,0,.12);
  transform: scale(0.8);
  opacity: 0;
  animation: gateAppear 0.6s ease-out forwards;
}
@keyframes gateAppear {
  to {
    transform: scale(1);
    opacity: 1;
  }
}

.gate-title{
  font-family:'Creepster', cursive; font-size: clamp(34px, 8vw, 72px);
  color: var(--orange-2); text-shadow: var(--glow);
  animation: gateTitlePulse 2s ease-in-out infinite;
}
@keyframes gateTitlePulse {
  0%, 100% { text-shadow: 0 0 18px rgba(255,107,0,.55); }
  50% { text-shadow: 0 0 28px rgba(255,140,26,.75); }
}

.gate-sub{ color:#ffe7d1; margin: 8px auto 18px; font-weight:600 }
.gate-btn{
  display:inline-flex; align-items:center; gap:.6rem; padding: .9rem 1.3rem; font-weight:800;
  background: linear-gradient(180deg, #ff7a12, #ff6b00);
  border: none; border-radius: 12px; color:#100404; cursor:pointer;
  box-shadow: 0 18px 45px rgba(255,107,0,.45);
  transition: var(--transition);
  transform: translateY(0);
}
.gate-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 22px 50px rgba(255,107,0,.5);
}
.gate-btn:active{ transform: translateY(1px) }

/* =========================
   FOOTER COUNTDOWN
   ========================= */
footer{
  position: relative; z-index:5;
  margin: 36px auto 80px; padding: 0 16px;
  max-width: 980px;
}
.countdown{
  border-radius: 18px;
  border:1px solid rgba(255,255,255,.12);
  background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
  box-shadow: inset 0 0 24px rgba(255,107,0,.12);
  padding: clamp(18px, 2.4vw, 26px);
  text-align:center;
  opacity: 0;
  transform: translateY(30px);
  animation: fadeInUp 1s ease-out 0.3s forwards;
}
@keyframes fadeInUp {
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.countdown h3{
  font-family:'Cinzel', serif;
  color: var(--orange-2);
  text-shadow: var(--glow);
  font-size: clamp(22px, 3.2vw, 30px);
  margin-bottom: 8px;
}
.timer{
  display:flex; justify-content:center; gap: clamp(10px, 3vw, 22px);
  flex-wrap:wrap; margin-top: 10px;
}
.time-box{
  min-width: 82px; padding: 10px 12px; border-radius: 12px;
  background: rgba(255,107,0,.08); border: 1px solid rgba(255,107,0,.35);
  box-shadow: inset 0 0 18px rgba(255,107,0,.15);
  transform: scale(0.8);
  opacity: 0;
  animation: timeBoxFloat 0.6s ease-out forwards;
}
.time-box:nth-child(1) { animation-delay: 0.4s; }
.time-box:nth-child(2) { animation-delay: 0.6s; }
.time-box:nth-child(3) { animation-delay: 0.8s; }
.time-box:nth-child(4) { animation-delay: 1s; }

@keyframes timeBoxFloat {
  to {
    transform: scale(1);
    opacity: 1;
  }
}

.time-box .num{
  font-size: clamp(26px, 5.2vw, 40px); font-weight:900; color:#fff; line-height:1
}
.time-box .lab{ font-size:.8rem; color:#ffd9c0; letter-spacing:.12em }

/* =========================
   UTILS
   ========================= */
hr.sep{
  border:none; height:1px; margin: 16px 0;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.18), transparent);
}
.note{ color:#d7cfff; opacity:.85; font-size:.95rem }

/* responsive tweaks */
@media (max-width:560px){
  .cta-row{ gap:10px }
  .btn{ flex:1 1 auto; justify-content:center }
}

/* Audio instructions */
.audio-instructions {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: rgba(0,0,0,0.95);
  color: white;
  padding: 25px;
  border-radius: 15px;
  border: 1px solid #ff6b00;
  z-index: 10000;
  text-align: center;
  max-width: 400px;
  font-family: 'Montserrat', sans-serif;
  box-shadow: 0 0 30px rgba(255,107,0,0.5);
  backdrop-filter: blur(10px);
  opacity: 0;
  transform: translate(-50%, -50%) scale(0.8);
  transition: all 0.3s ease;
}
.audio-instructions.show {
  opacity: 1;
  transform: translate(-50%, -50%) scale(1);
}

.audio-instructions h3 {
  color: #ff6b00;
  margin-bottom: 10px;
  font-size: 1.3rem;
}
.audio-instructions p {
  margin-bottom: 15px;
  line-height: 1.5;
}
.audio-instructions ol {
  text-align: left; 
  margin: 15px 0; 
  padding-left: 20px;
  line-height: 1.6;
}
.audio-instructions button {
  background: linear-gradient(180deg, #ff7a12, #ff6b00);
  color: white;
  border: none;
  padding: 12px 24px;
  margin-top: 15px;
  border-radius: 8px;
  cursor: pointer;
  font-weight: bold;
  font-size: 1.1rem;
  box-shadow: 0 8px 20px rgba(255,107,0,0.4);
  transition: all 0.3s ease;
}
.audio-instructions button:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 25px rgba(255,107,0,0.5);
}

/* Scroll progress indicator */
#scrollProgress {
  position: fixed;
  top: 0;
  left: 0;
  height: 4px;
  background: linear-gradient(90deg, #ff6b00, #b83af5);
  z-index: 9999;
  width: 0%;
  transition: width 0.1s ease-out;
}

/* New: Interactive hover effects */
.interactive-hover {
  transition: var(--transition);
  cursor: pointer;
}
.interactive-hover:hover {
  transform: translateY(-5px) scale(1.02);
  box-shadow: 0 20px 40px rgba(0,0,0,0.3);
}

/* New: Enhanced accessibility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0,0,0,0);
  white-space: nowrap;
  border: 0;
}

/* New: Performance optimized animations */
@media (prefers-reduced-motion: reduce) {
  * {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* New: Print styles */
@media print {
  body, .invite, .main, header, footer {
    background: white !important;
    color: black !important;
  }
  .bg-noise, .fog, .mover, .music-fab, #gate, .fog-burst, .lightning, .flash-overlay {
    display: none !important;
  }
  .poster {
    border: 1px solid #ccc;
  }
  .btn {
    border: 1px solid #000;
    background: white;
    color: #000;
  }
}
</style>
</head>
<body>

<!-- Scroll progress indicator -->
<div id="scrollProgress" aria-hidden="true"></div>

<!-- Background FX layers -->
<div class="bg-noise" aria-hidden="true"></div>
<div class="fog" aria-hidden="true"></div>

<!-- Movers are injected by JS (bats & ghosts) -->

<!-- Tap-to-start overlay (enables audio on móviles) -->
<section id="gate" aria-label="Ingresar a la invitación">
  <div class="gate-card">
    <h1 class="gate-title">Halloween Fest</h1>
    <p class="gate-sub">Toca "Entrar" para activar la <strong>música</strong> y los <strong>efectos</strong>.</p>
    <button class="gate-btn" id="enterBtn">🕯️ Entrar y activar música</button>
    <p class="note" style="margin-top:12px">Si luego quieres silenciarla, usa el botón flotante abajo a la derecha.</p>
  </div>
</section>

<!-- Flash overlay for lightning / camera flash -->
<div id="flash-overlay" aria-hidden="true"></div>

<header class="hero" id="top">
  <span class="badge">👑 Invitación Exclusiva</span>
  <h1 class="title">Daniel &amp; Sabrina</h1>
  <div class="subtitle">Festejamos nuestros cumpleaños - Noche de Disfraces — Halloween Épico</div>

  <div class="info-strip" role="list">
    <div class="info-chip" role="listitem" style="--delay: 1">📅 31 de Octubre — 21:00</div>
    <div class="info-chip" role="listitem" style="--delay: 2">📍 Santos Saya Norte 138</div>
    <div class="info-chip" role="listitem" style="--delay: 3">🎭 Dress code: ¡Disfraz obligatorio!</div>
  </div>
</header>

<main class="main">
  <section class="invite interactive-hover">
    <div class="invite-inner">
      <div class="details">
        <div class="names">¡Estás invitad@!</div>
        <div class="tagline">UNA NOCHE DE TERROR • MAGIA • MISTERIO</div>

        <div class="bullets">
          <div class="item"><div class="ico">🕯️</div><div class="txt">Recepción con luces, humo y ambientación cinematográfica.</div></div>
          <div class="item"><div class="ico">🦇</div><div class="txt">Murciélagos y fantasmas.</div></div>
          <div class="item"><div class="ico">🎵</div><div class="txt">Música temática (puedes activarla/pausarla cuando quieras).</div></div>
          <div class="item"><div class="ico">📸</div><div class="txt">Momentos sorpresa con relámpagos y destellos.</div></div>
        </div>

        <hr class="sep">

        <div class="cta-row">
          <a id="btn-whatsapp" class="btn whatsapp" href="javascript:void(0)" aria-label="Confirmar asistencia por WhatsApp">
            <span class="i">💬</span> Confirmar por WhatsApp
            <span class="spark" aria-hidden="true"></span>
          </a>

          <a id="btn-mapa" class="btn map" href="javascript:void(0)" aria-label="Abrir mapa con la dirección">
            <span class="i">🗺️</span> Abrir mapa
            <span class="spark" aria-hidden="true"></span>
          </a>

          <a id="btn-dress" class="btn dress" href="javascript:void(0)" aria-label="Ver dress code">
            <span class="i">🎭</span> Dress code
            <span class="spark" aria-hidden="true"></span>
          </a>

          <a id="btn-cal" class="btn cal" href="javascript:void(0)" aria-label="Agregar al calendario">
            <span class="i">🗓️</span> Agregar al calendario
            <span class="spark" aria-hidden="true"></span>
          </a>
        </div>

        <p class="note" style="margin-top:12px">Teléfono para confirmar: <strong>+54 3525 45 5314</strong></p>
      </div>

      <div class="poster">
        <div class="poster-title" aria-label="Halloween Fest">HALLOWEEN<br>FEST</div>
      </div>
    </div>
  </section>
</main>

<footer>
  <section class="countdown" aria-live="polite">
    <h3>Cuenta regresiva para la fiesta</h3>
    <div class="timer" id="timer">
      <div class="time-box"><div class="num" id="d">--</div><div class="lab">DÍAS</div></div>
      <div class="time-box"><div class="num" id="h">--</div><div class="lab">HORAS</div></div>
      <div class="time-box"><div class="num" id="m">--</div><div class="lab">MIN</div></div>
      <div class="time-box"><div class="num" id="s">--</div><div class="lab">SEG</div></div>
    </div>
  </section>
</footer>

<!-- Floating music control -->
<button class="music-fab" id="musicFab" aria-label="Reproducir o pausar música">
  <div class="disc" aria-hidden="true"></div>
  <strong id="musicLabel">Reproducir música</strong>
</button>

<!-- AUDIO -->
<audio id="bgAudio" loop preload="auto">
  <source src="https://cdn.pixabay.com/audio/2021/09/28/audio_363127311.mp3" type="audio/mpeg">
  Tu navegador no soporta el elemento de audio.
</audio>

<!-- Audio Instructions Modal -->
<div class="audio-instructions" id="audioInstructions">
  <h3>🔊 ¿No se escucha la música?</h3>
  <p>Sigue estos pasos para activar el sonido:</p>
  <ol style="text-align: left; margin: 15px 0; padding-left: 20px;">
    <li>Primero haz clic en "Entrar" arriba</li>
    <li>Luego haz clic en el botón "Reproducir música"</li>
    <li>Si usas celular, asegúrate de que el volumen esté alto</li>
  </ol>
  <button id="closeInstructions">Entendido</button>
</div>

<script>
/* =========================================================
   UTILS
   ========================================================= */
const qs = (s, o=document) => o.querySelector(s);
const qsa = (s, o=document) => [...o.querySelectorAll(s)];
const clamp = (n, min, max) => Math.max(min, Math.min(n, max));

/* Pointer spark on buttons */
qsa('.btn').forEach(b=>{
  b.addEventListener('pointermove',e=>{
    const r=b.getBoundingClientRect();
    b.style.setProperty('--mx', (e.clientX-r.left)+'px');
    b.style.setProperty('--my', (e.clientY-r.top)+'px');
  });
});

/* =========================================================
   BATS & GHOSTS SPAWNER
   ========================================================= */
function spawnMover(kind){
  const el = document.createElement('div');
  el.className = 'mover ' + kind;
  const span = document.createElement('span');
  span.textContent = kind==='bat' ? '🦇' : '👻';
  if (kind==='ghost') span.className='ghost-wobble';
  el.style.top = clamp(15 + Math.random()*70, 12, 82) + 'vh';
  el.style.animationDelay = (Math.random()*2)+'s';
  el.appendChild(span);
  document.body.appendChild(el);
  const life = kind==='bat' ? 14000 : 18000;
  setTimeout(()=> el.remove(), life + 1200);
}

// Enhanced bat and ghost spawning with better distribution
function initializeMovers() {
  // Initial bats
  for(let i=0;i<4;i++) {
    setTimeout(()=> spawnMover('bat'), 400*i+300);
  }
  // Initial ghosts
  for(let i=0;i<3;i++) {
    setTimeout(()=> spawnMover('ghost'), 600*i+800);
  }
  // Continuous spawning with random timing
  setInterval(()=>{
    const isBat = Math.random() > 0.5;
    spawnMover(isBat ? 'bat' : 'ghost');
  }, 2800);
}

/* =========================================================
   AUDIO GATE + TOGGLE
   ========================================================= */
const audio = qs('#bgAudio');
const gate = qs('#gate');
const enterBtn = qs('#enterBtn');
const musicFab = qs('#musicFab');
const musicLabel = qs('#musicLabel');
const audioInstructions = qs('#audioInstructions');

// Audio state management
let audioStarted = false;
let audioFailed = false;
let audioContext = null;

// Initialize Web Audio API for better control
function initAudioContext() {
  try {
    // Modern browsers
    if ('AudioContext' in window) {
      audioContext = new (window.AudioContext || window.webkitAudioContext)();
    }
  } catch (e) {
    console.log('Web Audio API not supported');
  }
}

async function startAudio(){
  try {
    // First, try HTML5 audio
    await audio.play();
    
    // If successful, update UI
    musicFab.classList.add('playing');
    musicLabel.textContent = 'Pausar música';
    audioStarted = true;
    
    // Hide instructions if shown
    audioInstructions.classList.remove('show');
    
    return true;
  } catch (err) {
    console.warn('Audio play blocked:', err);
    audioFailed = true;
    
    // Show instructions after a delay
    setTimeout(() => {
      if (!audioStarted) {
        audioInstructions.classList.add('show');
      }
    }, 1000);
    
    return false;
  }
}

// Click on "Enter" button
enterBtn.addEventListener('click', async ()=>{
  gate.style.display='none';
  
  // First attempt to play audio
  const success = await startAudio();
  
  if (!success) {
    // If failed, show instructions
    audioInstructions.classList.add('show');
  }
  
  // Always trigger effects
  triggerFlash();
  spawnMover('bat');
  
  // Start background movers
  initializeMovers();
});

// Click on music toggle button
musicFab.addEventListener('click', async ()=>{
  if(audio.paused){
    await startAudio();
  } else {
    audio.pause();
    musicFab.classList.remove('playing');
    musicLabel.textContent='Reproducir música';
  }
});

// Close instructions
qs('#closeInstructions').addEventListener('click', () => {
  audioInstructions.classList.remove('show');
});

// Try to play audio when user interacts with any button
qsa('a.btn, .music-fab, .gate-btn').forEach(el=>{
  el.addEventListener('click', async () => {
    if (!audioStarted && !audioFailed) {
      await startAudio();
    }
  });
});

// Also listen for keyboard events
qsa('a.btn, .music-fab, .gate-btn').forEach(el=>{
  el.addEventListener('keyup', async e=>{ 
    if((e.key==='Enter' || e.key===' ') && !audioStarted && !audioFailed) {
      await startAudio();
    }
  });
});

/* =========================================================
   BUTTON EFFECTS
   ========================================================= */
function triggerFlash(){
  const overlay = qs('#flash-overlay');
  overlay.classList.remove('flash-show'); // reset
  // force reflow
  void overlay.offsetWidth;
  overlay.classList.add('flash-show');
}
function fogBurstAt(x,y){
  const fog = document.createElement('div');
  fog.className='fog-burst';
  fog.style.setProperty('--x', x+'px');
  fog.style.setProperty('--y', y+'px');
  document.body.appendChild(fog);
  setTimeout(()=> fog.remove(), 1200);
}
function lightningAt(x,y){
  const bolt = document.createElement('div');
  bolt.className='lightning';
  bolt.style.setProperty('--x', x+'px');
  bolt.style.setProperty('--y', y+'px');
  document.body.appendChild(bolt);
  setTimeout(()=> bolt.remove(), 600);
}
function shake(node){ node.classList.add('shake'); setTimeout(()=> node.classList.remove('shake'), 650); }

/* Confetti (emoji) */
function confettiBurst(x,y){
  const emo = ['✨','🎃','👻','🦇','🕷️','🌟','💥','🪄'];
  for(let i=0;i<46;i++){
    const c = document.createElement('div');
    c.textContent = emo[Math.floor(Math.random()*emo.length)];
    c.style.position='fixed';
    c.style.left=x+'px';
    c.style.top=y+'px';
    c.style.zIndex='99999';
    c.style.fontSize=(14+Math.random()*26)+'px';
    c.style.pointerEvents='none';
    document.body.appendChild(c);
    const ang = Math.random() * Math.PI * 2;
    const dist = 160 + Math.random()*260;
    const dx = Math.cos(ang)*dist;
    const dy = Math.sin(ang)*dist;
    const t = 900 + Math.random()*900;
    c.animate([
      { transform:'translate(0,0) scale(.2)', opacity:0 },
      { transform:`translate(${dx*.5}px,${dy*.5}px) scale(1)`, opacity:1, offset:.35 },
      { transform:`translate(${dx}px,${dy}px) scale(.2)`, opacity:0 }
    ], { duration:t, easing:'cubic-bezier(.22,1,.36,1)' }).onfinish=()=> c.remove();
  }
}

/* WhatsApp (confetti + flash + open) */
qs('#btn-whatsapp').addEventListener('click', (e)=>{
  const r = e.currentTarget.getBoundingClientRect();
  const x = r.left + r.width/2, y = r.top + r.height/2;
  confettiBurst(x,y);
  triggerFlash();
  setTimeout(()=> window.open('https://wa.me/543525455314','_blank'), 700);
});

/* Mapa (lightning + shake + open maps) */
qs('#btn-mapa').addEventListener('click', (e)=>{
  const r = e.currentTarget.getBoundingClientRect();
  lightningAt(r.left + r.width*.65, r.top + r.height*.2);
  shake(document.body);
  const q = encodeURIComponent('Santos Saya Norte 138');
  setTimeout(()=> window.open(`https://www.google.com/maps/search/?api=1&query=${q}`, '_blank'), 380);
});

/* Dress code (fog burst + release bats + modal lightweight) */
qs('#btn-dress').addEventListener('click', (e)=>{
  const r = e.currentTarget.getBoundingClientRect();
  fogBurstAt(r.left + r.width/2, r.top + r.height/2);
  // bats volley
  for(let i=0;i<3;i++) setTimeout(()=> spawnMover('bat'), i*280);
  // tiny inline tip
  showToast('Ven con tu mejor disfraz. Bonus por maquillaje terrorífico 🩸🕸️');
});

/* Calendar (.ics download + sparkles) */
qs('#btn-cal').addEventListener('click', (e)=>{
  const r = e.currentTarget.getBoundingClientRect();
  confettiBurst(r.left + r.width/2, r.top + r.height/2);
  const ics = [
    'BEGIN:VCALENDAR',
    'VERSION:2.0',
    'PRODID:-//Halloween Fest//Invite//ES',
    'BEGIN:VEVENT',
    'UID:'+Date.now()+'@halloweenfest',
    'DTSTAMP:'+new Date().toISOString().replace(/\.|:/g, '').split('-').join('')+'Z',
    'DTSTART:20251031T210000',
    'DTEND:20251101T030000',
    'SUMMARY:Halloween Fest — Daniel & Sabrina',
    'LOCATION:Santos Saya Norte 138',
    'DESCRIPTION:Fiesta de disfraces épica. Confirma al +54 3525 45 5314',
    'END:VEVENT',
    'END:VCALENDAR'
  ].join('\r\n');
  const blob = new Blob([ics], {type:'text/calendar;charset=utf-8'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'HalloweenFest.ics';
  document.body.appendChild(a); a.click();
  setTimeout(()=>{ URL.revokeObjectURL(url); a.remove(); }, 800);
});

/* Little toast */
function showToast(msg){
  const t = document.createElement('div');
  t.textContent = msg;
  Object.assign(t.style,{
    position:'fixed', left:'50%', bottom:'24px', transform:'translateX(-50%)',
    padding:'12px 16px', borderRadius:'12px',
    background:'rgba(0,0,0,.85)', color:'#fff', border:'1px solid rgba(255,255,255,.2)',
    boxShadow:'0 10px 22px rgba(0,0,0,.45)', zIndex: 99999, backdropFilter:'blur(6px)',
    fontSize:'0.95rem', fontWeight:'500'
  });
  document.body.appendChild(t);
  t.animate([
    {opacity:0, transform:'translate(-50%, 10px) scale(0.95)'},
    {opacity:1, transform:'translate(-50%, 0) scale(1)'}
  ],{duration:280, easing:'cubic-bezier(0.175, 0.885, 0.32, 1.275)'});
  setTimeout(()=> t.animate([
    {opacity:1},
    {opacity:0, transform:'translate(-50%, 10px) scale(0.95)'}
  ],{duration:300}).onfinish=()=>t.remove(), 2800);
}

/* =========================================================
   COUNTDOWN
   ========================================================= */
const eventDate = new Date('2025-10-31T21:00:00'); // ajusta si hace falta tz
function tick(){
  const now = new Date();
  let diff = eventDate - now;
  if(diff < 0) diff = 0;
  const d = Math.floor(diff/86400000);
  const h = Math.floor((diff%86400000)/3600000);
  const m = Math.floor((diff%3600000)/60000);
  const s = Math.floor((diff%60000)/1000);
  qs('#d').textContent = String(d);
  qs('#h').textContent = String(h).padStart(2,'0');
  qs('#m').textContent = String(m).padStart(2,'0');
  qs('#s').textContent = String(s).padStart(2,'0');
}
setInterval(tick, 1000); tick();

/* =========================================================
   SCROLL PROGRESS INDICATOR
   ========================================================= */
const scrollProgress = qs('#scrollProgress');
function updateScrollProgress() {
  const scrollTop = window.pageYOffset;
  const docHeight = document.body.offsetHeight - window.innerHeight;
  const scrollPercent = (scrollTop / docHeight) * 100;
  scrollProgress.style.width = `${Math.min(scrollPercent, 100)}%`;
}
window.addEventListener('scroll', updateScrollProgress);

/* =========================================================
   ACCESSIBILITY & PERFORMANCE
   ========================================================= */
// Initialize on load
window.addEventListener('load', () => {
  // Initialize audio context
  initAudioContext();
  
  // Update scroll progress initially
  updateScrollProgress();
  
  // Add scroll event listener
  window.addEventListener('scroll', updateScrollProgress);
  
  // Performance optimization: throttle scroll events
  let ticking = false;
  window.addEventListener('scroll', () => {
    if (!ticking) {
      requestAnimationFrame(() => {
        updateScrollProgress();
        ticking = false;
      });
      ticking = true;
    }
  }, { passive: true });
});

// Add unload handler for cleanup
window.addEventListener('beforeunload', () => {
  if (audioContext) {
    audioContext.close();
  }
});

// Enhanced error handling for audio
audio.addEventListener('error', (e) => {
  console.error('Audio playback error:', e);
  showToast('Error al reproducir audio. Por favor, intenta nuevamente.');
});

// Handle visibility change (pause when tab is not active)
document.addEventListener('visibilitychange', () => {
  if (document.hidden && !audio.paused) {
    // Store state and pause
    const wasPlaying = !audio.paused;
    if (wasPlaying) {
      audio.pause();
      // Resume when tab becomes visible again
      const resumeAudio = () => {
        if (!document.hidden && wasPlaying) {
          startAudio();
        }
        document.removeEventListener('visibilitychange', resumeAudio);
      };
      document.addEventListener('visibilitychange', resumeAudio);
    }
  }
});

// Keyboard navigation improvements
document.addEventListener('keydown', (e) => {
  // Space or Enter to toggle music
  if ((e.key === ' ' || e.key === 'Enter') && 
      (document.activeElement === musicFab || document.activeElement === enterBtn)) {
    e.preventDefault();
    document.activeElement.click();
  }
  
  // Escape to close audio instructions
  if (e.key === 'Escape' && audioInstructions.classList.contains('show')) {
    audioInstructions.classList.remove('show');
  }
});

// Touch feedback for mobile
qsa('.btn, .music-fab, .gate-btn').forEach(el => {
  el.addEventListener('touchstart', () => {
    el.style.transform = 'translateY(1px) scale(0.99)';
  });
  el.addEventListener('touchend', () => {
    el.style.transform = '';
  });
});
</script>
</body>
</html>
